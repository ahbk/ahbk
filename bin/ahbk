#!/usr/bin/env bash

if [ $# -ne 1 ]; then
    echo "Usage: $0 [web|api|migrate]"
    exit 1
fi

if [ "$1" = "web" ]; then
    echo "Starting ahbk-web..."
    source @ahbk_env@ && @nodejs_18@/bin/node @ahbk_web@/build
elif [ "$1" = "api" ]; then
    echo "Starting ahbk-api..."
    source @ahbk_env@ && @ahbk_api@/bin/uvicorn ahbk_api.main:app
elif [ "$1" = "migrate" ]; then
    echo "Migrating database..."
    source @ahbk_env@ && @ahbk_api@/bin/alembic upgrade head
else
    echo "Invalid argument. Use 'web', 'api' or 'migrate'."
    exit 1
fi
